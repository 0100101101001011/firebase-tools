#!/usr/bin/env node

var optimist = require('optimist'),
    argv = optimist
              .usage('Usage: firebase')
              .alias('f', 'firebase')
              .alias('t', 'template')
              .argv,
    prompt = require('prompt'),
    Firebase = require('../lib/firebase');

prompt.override = argv;
prompt.message = '';
prompt.delimiter = '';

if (argv.version) {

  console.log('\nFirebase CLI version: ' + Firebase.version + '\n');

} else if (argv._.length === 0) {

  // Require at least one non-hyphenated option
  Firebase.showHelp();

} else {
  // Top-level router
  switch (argv._[0]) {

    // Top-level functionality

    case 'login':
      Firebase.login();
      break;
    case 'logout':
      Firebase.logout();
      break;
    case 'list':
      Firebase.list();
      break;

    // Submodules

    case 'app':
      // Defer to submodule router
      new Firebase.App();
      break;

    default:
      // TODO: Print useful help information
      Firebase.showHelp();
  }
}
