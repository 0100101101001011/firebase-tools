#!/usr/bin/env node

var optimist = require('optimist'),
    argv = optimist
              .alias('f', 'firebase')
              .alias('h', 'help')
              .alias('p', 'public')
              .alias('r', 'rules')
              .alias('t', 'template')
              .alias('v', 'version')
              .argv,
    prompt = require('prompt'),
    firebase = require('../lib/firebase');

prompt.override = argv;
prompt.message = '';
prompt.delimiter = '';
prompt.colors = false;

if (argv.help) {

  firebase.showHelp();

} else if (argv.version) {

  firebase.showVersion();

} else if (argv._.length === 0) {

  // Require at least one non-hyphenated option
  firebase.showHelp();

} else {
  // Top-level router
  switch (argv._[0]) {

    // Top-level functionality

    case 'login':
      firebase.login();
      break;
    case 'logout':
      firebase.logout();
      break;
    case 'list':
      firebase.list();
      break;

    // Submodules

    case 'app':
      // Defer to submodule router
      new firebase.App();
      break;

    default:
      firebase.showHelp();
  }
}
